# Техническое задание (ТЗ) на разработку корпоративного сервиса коммуникаций

## 1. Цель и назначение документа
Настоящий документ определяет требования к разработке платформы для корпоративных коммуникаций, включающей видеовстречи, мессенджер, вебинары и инструменты для совместной работы. Система должна обеспечивать высокую производительность, безопасность и кроссплатформенность.

## 2. Общие сведения о проекте
**Название проекта:** rust-vcs (рабочее название)  
**Целевая аудитория:** Внутренние команды компаний (B2B), внешние участники мероприятий (B2B2C), образовательные учреждения.  
**Ключевая особенность:** Безопасность по умолчанию (закрытые встречи) и возможность подключения без регистрации по ссылке.

## 3. Технологический стек
*   **Бэкенд (Core/Media):** Rust (акторы, обработка сигналинга, бизнес-логика, асинхронный рантайм Tokio).
*   **Медиасервер:** Mediasoup (реализация на C++, управление через Rust-биндинги или FFI).
*   **Фронтенд (Web):** Rust (Leptos) + WASM. Библиотека компонентов: **[rust-ui.com](https://rust-ui.com)** (набор готовых компонентов на Leptos + Tailwind CSS).
*   **Нативные приложения:** Rust (ядро) + обертки платформ (Tauri для Desktop; для мобильных платформ — компиляция в библиотеки .so/.a с нативным UI или гибридным рендерингом).
*   **Протоколы:** WebRTC (медиа), WebSockets/HTTP2 (сигналинг), SRTP/DTLS, TLS 1.3.

## 4. Функциональные требования

### 4.1. Управление встречами и вебинарами (Rust + SFU (Mediasoup) )
*   **Создание встреч:** Возможность создания мгновенных и запланированных видеоконференций. Генерация уникальных ссылок-приглашений.
*   **Управление участниками:** Роли (организатор, докладчик, участник). Контроль доступа: модерация, «поднятая рука», включение/отключение микрофона модератором.
*   **Режимы:** Режим равноправной конференции (meeting) и режим вебинара (трансляция на большую аудиторию с ограниченным числом спикеров).
*   **Онлайн-доски:** Интеграция с доской для рисования/заметок. Данные должны синхронизироваться в реальном времени (WebRTC DataChannel).

### 4.2. Корпоративный мессенджер (Rust + WebSockets)
*   **Типы чатов:** Личные сообщения, групповые чаты, каналы (анонсы).
*   **Контент:** Текст, реакции, пересылка сообщений, вложения (файлы, изображения). Использование компонентов `rust-ui.com` для отображения аватаров, списков чатов и сообщений.
*   **Интеграция:** Привязка сообщений к конкретным встречам (чат встречи сохраняется и после её окончания).

### 4.3. Функции искусственного интеллекта (Заметки, Протокол, Расшифровка)
*   **Автоматические заметки:** Система должна фиксировать ключевые моменты (требуется разработка отдельного микросервиса на Rust для обработки аудиопотоков или интеграция с ASR).
*   **Транскрибация (Speech-to-Text):** Преобразование речи в текст в реальном времени или постфактум.
*   **Пересказ и протокол:** Генерация саммари встречи по окончании на основе транскрипта.
*   **Запись встреч:** Запись потоков (audio/video) на сервере (Mediasoup может отдавать потоки для рекордера).

### 4.4. Регистрация и безопасность
*   **Регистрация:** Стандартная регистрация для сотрудников (email/SSO). Использование готовых форм с `rust-ui.com`.
*   **Внешний доступ:** Участник получает ссылку, вводит имя и заходит во встречу без создания аккаунта.
*   **Шифрование:**
    *   TLS 1.3 для HTTPS и Signal-канала.
    *   SRTP/DTLS для медиапотоков (End-to-End шифрование в пределах комнаты или транспорта, стандарт WebRTC).

### 4.5. Аналитика и отчеты
*   **Для вебинаров/трансляций:** Количество подключений, время просмотра, действия пользователей. Отображение статистики через табличные компоненты `rust-ui.com` (аналогично разделу "Payments" на сайте).
*   **Для встреч:** Отчет по участникам, длительность, ссылка на запись/расшифровку.

## 5. Клиентская часть (Leptos и нативные приложения)

### 5.1. Веб-клиент (Leptos)
*   **Интерфейс:** Адаптивная верстка (десктоп, планшет, мобильные браузеры).
*   **UI Компоненты:** Использовать библиотеку **rust-ui.com** в качестве основы для построения интерфейса. Применить готовые компоненты:
    *   **Карточки и списки** — для отображения участников встречи, контактов.
    *   **Модальные окна и диалоги** — для подтверждения действий (удаление, выход).
    *   **Формы и поля ввода** — для создания встреч, настроек профиля.
    *   **Таблицы данных** — для отображения статистики и истории встреч.
    *   **Календарь** — для бронирования переговорных комнат.
    *   **Настройки (Cookie Settings)** — для страниц параметров конфиденциальности.
    *   **Аватары с инициалами** — для чата и списка участников.
*   **Кастомизация:** Все компоненты должны легко настраиваться под фирменный стиль (брендирование для вебинаров) с использованием Tailwind CSS.
*   **Медиа:** Запись медиа с устройств (getUserMedia), отображение Video/Audio троков (WebRTC).
*   **Производительность:** Использование реактивности Leptos для минимизации перерисовок.

### 5.2. Десктопные приложения (Windows, macOS, Linux)
*   **Сборка:** Использование Tauri (бэкенд на Rust + фронтенд на Leptos с компонентами `rust-ui.com`).
*   **Функции:** Захват экрана (с высоким FPS), системные уведомления, автозапуск.

### 5.3. Мобильные приложения (Android, iOS)
*   **Ядро:** Бизнес-логика и сетевое взаимодействие на Rust, скомпилированное в мобильную библиотеку (.so / .a).
*   **UI:** Нативные компоненты платформ или решение на базе Leptos с рендерингом через WebView (гибрид) или Tauri.

## 6. Нефункциональные требования

*   **Нагрузка:**
    *   Один сервер Mediasoup (инстанс) должен выдерживать до 500 одновременных участников в режиме вебинара.
    *   До 50 одновременных видеопотоков в активной встрече.
*   **Безопасность данных:**
    *   Сквозное шифрование для приватных сообщений (опционально).
    *   Отсутствие хранения расшифровок встреч без явного согласия организатора.
*   **Локализация:** Поддержка мультиязычности (RUI, EN).

## 7. Архитектура и бэкенд (Rust + SFU (Mediasoup))

*   **Ядро (Signaling Server):**
    *   Написано на Rust с использованием асинхронного рантайма (Tokio).
    *   Управление комнатами (Rust-обертки над Mediasoup `Router`, `Transport`, `Producer`, `Consumer`).
    *   REST API для управления пользователями и комнатами.
*   **Mediasoup:**
    *   Запускается как дочерний процесс (Worker). Rust-сервер управляет им через сокеты.
*   **Хранение данных:**
    *   PostgreSQL (пользователи, метаданные встреч, сообщения чата).
    *   S3/MinIO (для хранения записей встреч, аватарок, вложений).
*   **Сигналинг:** WebSockets (для обмена SDP и ICE кандидатами).

## 8. Этапы реализации (Roadmap)

### Этап 1: MVP (Minimum Viable Product)
1.  Авторизация сотрудников и создание встречи "по ссылке". Использование форм `rust-ui.com` для логина.
2.  Видеоконференция 1 на 1 (P2P) или малая группа (через Mediasoup SFU).
3.  Текстовый чат внутри встречи (DataChannel) с использованием компонентов сообщений.
4.  Шифрование TLS/DTLS.

### Этап 2: Основной функционал
1.  Корпоративный мессенджер (персистентные чаты) с UI на основе списков и аватаров `rust-ui.com`.
2.  Режим вебинара (публикация видео только у спикеров).
3.  Запись встреч на сервер.
4.  Десктоп-приложения (Tauri).

### Этап 3: AI и продвинутые функции
1.  Транскрибация в реальном времени.
2.  Генерация протоколов встреч.
3.  Онлайн-доски и совместное редактирование.
4.  Мобильные приложения.

### Этап 4: Масштабирование и B2B
1.  Брендирование страниц вебинаров (кастомизация компонентов `rust-ui.com`).
2.  Интеграция с календарями (Google, Outlook) для бронирования переговорных комнат (использование календаря `rust-ui.com`).
3.  Детальная аналитика для администраторов (таблицы `rust-ui.com`).

## 9. Требования к интеграциям
*   **Календари:** Поддержка iCal, интеграция с Google Calendar API / Outlook API для бронирования переговорок.
*   **SSO:** SAML/OIDC для корпоративных клиентов.

## 10. Критерии приемки
*   Успешное проведение тестовой видеоконференции с 10 активными участниками.
*   Возможность внешнего пользователя зайти по ссылке без регистрации.
*   Шифрование медиатрафика подтверждено дампом трафика (Wireshark).
*   Интерфейс, построенный на компонентах **rust-ui.com**, корректо отображается в последних версиях Chrome, Firefox, Safari.
*   Интерфейс полностью адаптивен и удобен на мобильных устройствах и планшетах.

---

Этот документ готов к передаче разработчикам. Он содержит все ключевые детали: от высокоуровневой архитектуры до конкретных UI-решений.
